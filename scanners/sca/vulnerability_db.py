# scanners/sca/vulnerability_db.py

PQC_VULNERABLE_LIBRARIES = {
    "python": {
        "pycrypto": {
            "all_versions_vulnerable": True,
            "reason": "RSA, DSA 등 PQC 취약 알고리즘만 지원",
            "pqc_support": False,
            "alternatives": [
                {"name": "pqcrypto", "version": ">=0.2.0"},
                {"name": "liboqs-python", "version": ">=0.7.0"}
            ]
        },
        "cryptography": {
            "all_versions_vulnerable": False,
            "vulnerable_versions": ["<41.0.0"],
            "reason": "41.0.0 미만 버전은 PQC 미지원",
            "pqc_support": "partial",
            "pqc_version": ">=41.0.0",
            "alternatives": []
        },
        "m2crypto": {
            "all_versions_vulnerable": True,
            "reason": "OpenSSL 기반, PQC 미지원",
            "pqc_support": False,
            "alternatives": [
                {"name": "pqcrypto", "version": ">=0.2.0"}
            ]
        },
        "rsa": {
            "all_versions_vulnerable": True,
            "reason": "RSA 전용 라이브러리",
            "pqc_support": False,
            "alternatives": [
                {"name": "pqcrypto", "version": ">=0.2.0"}
            ]
        },
        "ecdsa": {
            "all_versions_vulnerable": True,
            "reason": "ECDSA 전용 라이브러리",
            "pqc_support": False,
            "alternatives": [
                {"name": "pqcrypto", "version": ">=0.2.0"}
            ]
        }
    },
    
    "javascript": {
        "node-rsa": {
            "all_versions_vulnerable": True,
            "reason": "RSA 전용 라이브러리",
            "pqc_support": False,
            "alternatives": [
                {"name": "@stablelib/kyber", "version": "latest"}
            ]
        },
        "jsrsasign": {
            "all_versions_vulnerable": True,
            "reason": "RSA 서명 전용",
            "pqc_support": False,
            "alternatives": []
        },
        "crypto-js": {
            "all_versions_vulnerable": True,
            "reason": "비대칭키 암호화 시 PQC 미지원",
            "pqc_support": "none",
            "alternatives": []
        },
        "elliptic": {
            "all_versions_vulnerable": True,
            "reason": "ECC 전용 라이브러리",
            "pqc_support": False,
            "alternatives": []
        }
    },
    
    "java": {
        "bouncycastle": {
            "all_versions_vulnerable": False,
            "vulnerable_versions": ["<1.70"],
            "reason": "1.70 이전 버전은 PQC 미지원",
            "pqc_support": "partial",
            "pqc_version": ">=1.70",
            "alternatives": []
        }
    }
}