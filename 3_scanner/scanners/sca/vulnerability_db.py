# scanners/sca/vulnerability_db.py

PQC_VULNERABLE_LIBRARIES = {
    "python": {
        "pycrypto": {
            "all_versions_vulnerable": True,
            "reason": "RSA/DSA library without PQC support.",
            "pqc_support": False,
            "alternatives": [
                {"name": "pqcrypto", "version": ">=0.2.0"},
                {"name": "liboqs-python", "version": ">=0.7.0"}
            ]
        },
        "cryptography": {
            "all_versions_vulnerable": False,
            "vulnerable_versions": ["<41.0.0"],
            "reason": "Versions below 41.0.0 lack PQC support.",
            "pqc_support": "partial",
            "pqc_version": ">=41.0.0",
            "alternatives": []
        },
        "m2crypto": {
            "all_versions_vulnerable": True,
            "reason": "OpenSSL-based library without PQC support.",
            "pqc_support": False,
            "alternatives": [
                {"name": "pqcrypto", "version": ">=0.2.0"}
            ]
        },
        "rsa": {
            "all_versions_vulnerable": True,
            "reason": "RSA-only library without PQC support.",
            "pqc_support": False,
            "alternatives": [
                {"name": "pqcrypto", "version": ">=0.2.0"}
            ]
        },
        "ecdsa": {
            "all_versions_vulnerable": True,
            "reason": "ECDSA-only library without PQC support.",
            "pqc_support": False,
            "alternatives": [
                {"name": "pqcrypto", "version": ">=0.2.0"}
            ]
        }
    },
    
    "javascript": {
        "node-rsa": {
            "all_versions_vulnerable": True,
            "reason": "RSA-only library without PQC support.",
            "pqc_support": False,
            "alternatives": [
                {"name": "@stablelib/kyber", "version": "latest"}
            ]
        },
        "jsrsasign": {
            "all_versions_vulnerable": True,
            "reason": "RSA signature library without PQC support.",
            "pqc_support": False,
            "alternatives": []
        },
        "crypto-js": {
            "all_versions_vulnerable": True,
            "reason": "Symmetric crypto library without PQC support.",
            "pqc_support": "none",
            "alternatives": []
        },
        "elliptic": {
            "all_versions_vulnerable": True,
            "reason": "ECC library without PQC support.",
            "pqc_support": False,
            "alternatives": []
        }
    },
    
    "java": {
        "bouncycastle": {
            "all_versions_vulnerable": False,
            "vulnerable_versions": ["<1.70"],
            "reason": "Versions below 1.70 lack PQC support.",
            "pqc_support": "partial",
            "pqc_version": ">=1.70",
            "alternatives": []
        }
    }
}
